<div class="dashboard-content">
    <section class="welcome-section">
        <div class="welcome-card">
            <i class="fas fa-handshake welcome-icon"></i>
            <h2>BIENVENIDO AL PANEL DE ADMINISTRACIÓN</h2>
            <p class="lead-text">Aquí podrás gestionar y supervisar todos los perfiles de licitación de Jeguen Solutions. Si tienes dudas sobre el funcionamiento del sistema, favor de consultar el manual de usuario.</p>
            <p> <strong>¡Estamos trabajando para ofrecerte más funcionalidades muy pronto!</strong></p>
            <a href="/admin/logout" class="btn btn-primary-alt">
                <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
            </a>
        </div>
    </section>

    <section class="licitaciones-section">
        <div class="section-header">
            <h3><i class="fas fa-file-contract"></i> PERFILES DE LICITACIONES EXISTENTES</h3>
            <a href="/admin/profiles/new" class="btn btn-secondary-alt">
                <i class="fas fa-plus-circle"></i> Crear Nueva Licitación
            </a>
        </div>

        <% if (profiles && profiles.length > 0) { %>
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nombre del Perfil</th>
                            <th>Slug</th>
                            <th>Estado</th>
                            <th class="text-center">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% profiles.forEach(function(profile) { %>
                            <tr>
                                <td><%= profile.profileName %></td>
                                <td><%= profile.slug %></td>
                                <td>
                                    <span class="status-<%= profile.isActive ? 'active' : 'inactive' %>">
                                        <%= profile.isActive ? 'Activo' : 'Inactivo' %>
                                    </span>
                                </td>
                                <td class="actions-cell">
                                    <a href="/admin/profiles/edit/<%= profile.id %>" class="action-btn edit" title="Editar Perfil">
                                        <i class="fas fa-edit"></i> Editar
                                    </a>
                                    <a href="/servicio/<%= profile.slug %>" target="_blank" class="action-btn view" title="Ver Licitación Pública">
                                        <i class="fas fa-external-link-alt"></i> Ver
                                    </a>
<form action="/admin/profiles/delete/<%= profile.id %>?_method=DELETE" method="POST" style="display:inline-block;" 
    onsubmit="return confirmDelete(event, '<%= profile.profileName %>');">
    <button type="submit" class="action-btn delete" title="Eliminar Perfil">
        <i class="fas fa-trash-alt"></i> Eliminar
    </button>
</form>

                                </td>
                            </tr>
                        <% }); %>
                    </tbody>
                </table>
            </div>
        <% } else { %>
            <div class="empty-state">
                <i class="fas fa-info-circle empty-icon"></i>
                <p>No hay perfiles de licitación creados aún.</p>
                <a href="/admin/profiles/new" class="btn btn-primary-alt">
                    <i class="fas fa-plus-circle"></i> Crea uno nuevo ahora
                </a>
            </div>
        <% } %>
    </section>
</div>

<style>
    /* Estilos para SweetAlert2 */
    .swal2-popup {
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }
    .swal2-title {
        color: #333;
        font-size: 1.5em;
    }
    .swal2-html-container {
        color: #666;
    }
    .swal2-confirm, .swal2-cancel {
        border-radius: 5px;
        font-weight: bold;
        padding: 10px 20px;
    }
    .swal2-confirm {
        background-color: #dc3545 !important; /* Rojo de Bootstrap */
    }
    .swal2-cancel {
        background-color: #6c757d !important; /* Gris de Bootstrap */
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    // Tu función JavaScript actualizada
    function confirmDelete(event, profileName) {
        event.preventDefault(); // Detiene el envío del formulario inicialmente
        
        Swal.fire({
            title: `¿Estás seguro de que quieres eliminar a <strong>${profileName}</strong>?`,
            html: '¡Esta acción no se puede deshacer! Se eliminará el perfil y todo su contenido asociado.',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#dc3545', // Rojo de Bootstrap
            cancelButtonColor: '#6c757d', // Gris de Bootstrap
            confirmButtonText: '<i class="fas fa-trash-alt"></i> Sí, eliminar',
            cancelButtonText: '<i class="fas fa-times-circle"></i> Cancelar'
        }).then((result) => {
            if (result.isConfirmed) {
                // Si el usuario confirma, envía el formulario
                event.target.submit();
            }
        });

        return false; // Evita el envío del formulario si la alerta se cierra
    }
</script>